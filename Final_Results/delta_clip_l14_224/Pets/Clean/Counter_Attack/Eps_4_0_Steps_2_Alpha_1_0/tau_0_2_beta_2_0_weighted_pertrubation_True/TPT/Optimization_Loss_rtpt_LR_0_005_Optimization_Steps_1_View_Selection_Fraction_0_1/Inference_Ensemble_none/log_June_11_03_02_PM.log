2025-06-11 15:02:02,076 - log - INFO - ==========================================
data:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/atpt_data/downstream_datasets
test_sets:Pets
dataset_mode:test
arch:delta_clip_l14_224
resolution:224
workers:4
no_pin_memory:False
batch_size:64
print_freq:20
gpu:0
no_cudnn_benchmark:False
n_ctx:4
ctx_init:a_photo_of_a
tpt_loss:rtpt
seed:0
output_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/atpt_data/delta_clip_l14_224/Pets
log_output_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/ATPT/Final_Results/delta_clip_l14_224/Pets
eps:0.0
alpha:0.0
alpha_eps_ratio:4.0
steps:0
lr:0.005
selection_p:0.1
tta_steps:1
ensemble_type:none
top_k:20
softmax_temp:0.01
counter_attack:True
counter_attack_type:pgd
counter_attack_steps:2
counter_attack_eps:4.0
counter_attack_alpha:1.0
counter_attack_tau_thres:0.2
counter_attack_beta:2.0
counter_attack_weighted_perturbations:True
pgd_clip_pure_i_text_embeddings:null
pgd_counter_and_clipure_i_lamda:1.0
selected_id_name:selected_topk.json
weighted_score_name:weighted_scores.json
batch_entropy_name:entropies.json
log_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/ATPT/Final_Results/delta_clip_l14_224/Pets/Clean/Counter_Attack/Eps_4_0_Steps_2_Alpha_1_0/tau_0_2_beta_2_0_weighted_pertrubation_True/TPT/Optimization_Loss_rtpt_LR_0_005_Optimization_Steps_1_View_Selection_Fraction_0_1/Inference_Ensemble_none

2025-06-11 15:02:02,077 - log - INFO - Use GPU: 0 for training
2025-06-11 15:04:11,248 - log - INFO - Freezing all parameters except prompt learner
2025-06-11 15:04:11,249 - log - INFO - => Model created: visual backbone delta_clip_l14_224
2025-06-11 15:04:11,256 - log - INFO - Number of test samples: 3669
2025-06-11 15:04:11,257 - log - INFO - Evaluating dataset: Pets
2025-06-11 15:04:11,258 - log - INFO - Starting evaluation with batch size: 64, selection percentage: 0.1
2025-06-11 15:04:11,258 - log - INFO - Test-time adaptation steps: 1, learning rate: 0.005
2025-06-11 15:04:11,258 - log - INFO - Using counter-attack with epsilon: 4.000000, alpha: 0.000000, steps: 2, tau_thres: 0.2, beta: 2.0, weighted perturbation: True
2025-06-11 15:05:05,759 - log - INFO - iter:20/3669, clip_acc1=45.0, tta_acc1=45.0
2025-06-11 15:05:05,759 - log - INFO - iter:20/3669, Original Acc@1: 45.00, Acc@5: 95.00, TTA Acc@1: 45.00, Acc@5: 95.00
2025-06-11 15:05:53,208 - log - INFO - iter:40/3669, clip_acc1=50.0, tta_acc1=52.5
2025-06-11 15:05:53,208 - log - INFO - iter:40/3669, Original Acc@1: 50.00, Acc@5: 97.50, TTA Acc@1: 52.50, Acc@5: 97.50
2025-06-11 15:06:40,167 - log - INFO - iter:60/3669, clip_acc1=55.000003814697266, tta_acc1=55.000003814697266
2025-06-11 15:06:40,167 - log - INFO - iter:60/3669, Original Acc@1: 55.00, Acc@5: 98.33, TTA Acc@1: 55.00, Acc@5: 98.33
2025-06-11 15:07:26,811 - log - INFO - iter:80/3669, clip_acc1=55.0, tta_acc1=55.0
2025-06-11 15:07:26,812 - log - INFO - iter:80/3669, Original Acc@1: 55.00, Acc@5: 98.75, TTA Acc@1: 55.00, Acc@5: 98.75
2025-06-11 15:08:13,771 - log - INFO - iter:100/3669, clip_acc1=57.0, tta_acc1=56.0
2025-06-11 15:08:13,771 - log - INFO - iter:100/3669, Original Acc@1: 57.00, Acc@5: 99.00, TTA Acc@1: 56.00, Acc@5: 99.00
2025-06-11 15:09:00,576 - log - INFO - iter:120/3669, clip_acc1=62.500003814697266, tta_acc1=61.66667175292969
2025-06-11 15:09:00,576 - log - INFO - iter:120/3669, Original Acc@1: 62.50, Acc@5: 99.17, TTA Acc@1: 61.67, Acc@5: 99.17
2025-06-11 15:09:47,435 - log - INFO - iter:140/3669, clip_acc1=65.0, tta_acc1=64.28571319580078
2025-06-11 15:09:47,435 - log - INFO - iter:140/3669, Original Acc@1: 65.00, Acc@5: 99.29, TTA Acc@1: 64.29, Acc@5: 99.29
2025-06-11 15:10:35,709 - log - INFO - iter:160/3669, clip_acc1=67.5, tta_acc1=66.25
2025-06-11 15:10:35,709 - log - INFO - iter:160/3669, Original Acc@1: 67.50, Acc@5: 99.38, TTA Acc@1: 66.25, Acc@5: 99.38
2025-06-11 15:11:22,733 - log - INFO - iter:180/3669, clip_acc1=69.44444274902344, tta_acc1=68.33333587646484
2025-06-11 15:11:22,734 - log - INFO - iter:180/3669, Original Acc@1: 69.44, Acc@5: 99.44, TTA Acc@1: 68.33, Acc@5: 99.44
2025-06-11 15:12:09,641 - log - INFO - iter:200/3669, clip_acc1=71.0, tta_acc1=70.0
2025-06-11 15:12:09,642 - log - INFO - iter:200/3669, Original Acc@1: 71.00, Acc@5: 99.00, TTA Acc@1: 70.00, Acc@5: 99.00
2025-06-11 15:12:56,514 - log - INFO - iter:220/3669, clip_acc1=72.7272720336914, tta_acc1=71.36363220214844
2025-06-11 15:12:56,515 - log - INFO - iter:220/3669, Original Acc@1: 72.73, Acc@5: 99.09, TTA Acc@1: 71.36, Acc@5: 99.09
2025-06-11 15:13:43,286 - log - INFO - iter:240/3669, clip_acc1=72.08333587646484, tta_acc1=70.41667175292969
2025-06-11 15:13:43,286 - log - INFO - iter:240/3669, Original Acc@1: 72.08, Acc@5: 99.17, TTA Acc@1: 70.42, Acc@5: 99.17
2025-06-11 15:14:29,967 - log - INFO - iter:260/3669, clip_acc1=71.92308044433594, tta_acc1=70.38461303710938
2025-06-11 15:14:29,968 - log - INFO - iter:260/3669, Original Acc@1: 71.92, Acc@5: 99.23, TTA Acc@1: 70.38, Acc@5: 99.23
2025-06-11 15:15:16,819 - log - INFO - iter:280/3669, clip_acc1=72.85713958740234, tta_acc1=71.78571319580078
2025-06-11 15:15:16,819 - log - INFO - iter:280/3669, Original Acc@1: 72.86, Acc@5: 99.29, TTA Acc@1: 71.79, Acc@5: 99.29
2025-06-11 15:16:03,524 - log - INFO - iter:300/3669, clip_acc1=73.0, tta_acc1=71.66667175292969
2025-06-11 15:16:03,525 - log - INFO - iter:300/3669, Original Acc@1: 73.00, Acc@5: 99.33, TTA Acc@1: 71.67, Acc@5: 99.33
2025-06-11 15:16:50,201 - log - INFO - iter:320/3669, clip_acc1=73.4375, tta_acc1=72.5
2025-06-11 15:16:50,201 - log - INFO - iter:320/3669, Original Acc@1: 73.44, Acc@5: 99.38, TTA Acc@1: 72.50, Acc@5: 99.38
2025-06-11 15:17:36,991 - log - INFO - iter:340/3669, clip_acc1=74.70588684082031, tta_acc1=73.82353210449219
2025-06-11 15:17:36,991 - log - INFO - iter:340/3669, Original Acc@1: 74.71, Acc@5: 99.41, TTA Acc@1: 73.82, Acc@5: 99.41
2025-06-11 15:18:23,732 - log - INFO - iter:360/3669, clip_acc1=75.55555725097656, tta_acc1=74.72222137451172
2025-06-11 15:18:23,732 - log - INFO - iter:360/3669, Original Acc@1: 75.56, Acc@5: 99.44, TTA Acc@1: 74.72, Acc@5: 99.44
2025-06-11 15:19:10,355 - log - INFO - iter:380/3669, clip_acc1=76.57894897460938, tta_acc1=75.52632141113281
2025-06-11 15:19:10,355 - log - INFO - iter:380/3669, Original Acc@1: 76.58, Acc@5: 99.47, TTA Acc@1: 75.53, Acc@5: 99.47
2025-06-11 15:19:57,102 - log - INFO - iter:400/3669, clip_acc1=77.75, tta_acc1=76.75
2025-06-11 15:19:57,102 - log - INFO - iter:400/3669, Original Acc@1: 77.75, Acc@5: 99.50, TTA Acc@1: 76.75, Acc@5: 99.50
2025-06-11 15:20:43,746 - log - INFO - iter:420/3669, clip_acc1=78.33333587646484, tta_acc1=77.3809585571289
2025-06-11 15:20:43,746 - log - INFO - iter:420/3669, Original Acc@1: 78.33, Acc@5: 99.29, TTA Acc@1: 77.38, Acc@5: 99.29
2025-06-11 15:21:30,597 - log - INFO - iter:440/3669, clip_acc1=79.31817626953125, tta_acc1=78.40908813476562
2025-06-11 15:21:30,597 - log - INFO - iter:440/3669, Original Acc@1: 79.32, Acc@5: 99.32, TTA Acc@1: 78.41, Acc@5: 99.32
2025-06-11 15:22:17,121 - log - INFO - iter:460/3669, clip_acc1=80.2173843383789, tta_acc1=79.34782409667969
2025-06-11 15:22:17,122 - log - INFO - iter:460/3669, Original Acc@1: 80.22, Acc@5: 99.35, TTA Acc@1: 79.35, Acc@5: 99.35
2025-06-11 15:23:03,964 - log - INFO - iter:480/3669, clip_acc1=81.04167175292969, tta_acc1=80.20833587646484
2025-06-11 15:23:03,964 - log - INFO - iter:480/3669, Original Acc@1: 81.04, Acc@5: 99.38, TTA Acc@1: 80.21, Acc@5: 99.38
2025-06-11 15:23:51,465 - log - INFO - iter:500/3669, clip_acc1=81.80000305175781, tta_acc1=81.00000762939453
2025-06-11 15:23:51,465 - log - INFO - iter:500/3669, Original Acc@1: 81.80, Acc@5: 99.40, TTA Acc@1: 81.00, Acc@5: 99.40
2025-06-11 15:24:38,509 - log - INFO - iter:520/3669, clip_acc1=82.11538696289062, tta_acc1=81.34615325927734
2025-06-11 15:24:38,509 - log - INFO - iter:520/3669, Original Acc@1: 82.12, Acc@5: 99.42, TTA Acc@1: 81.35, Acc@5: 99.42
2025-06-11 15:25:25,516 - log - INFO - iter:540/3669, clip_acc1=81.66666412353516, tta_acc1=81.29629516601562
2025-06-11 15:25:25,516 - log - INFO - iter:540/3669, Original Acc@1: 81.67, Acc@5: 99.44, TTA Acc@1: 81.30, Acc@5: 99.44
2025-06-11 15:26:12,253 - log - INFO - iter:560/3669, clip_acc1=81.25, tta_acc1=81.07142639160156
2025-06-11 15:26:12,253 - log - INFO - iter:560/3669, Original Acc@1: 81.25, Acc@5: 99.46, TTA Acc@1: 81.07, Acc@5: 99.46
2025-06-11 15:26:59,228 - log - INFO - iter:580/3669, clip_acc1=80.17241668701172, tta_acc1=80.3448257446289
2025-06-11 15:26:59,228 - log - INFO - iter:580/3669, Original Acc@1: 80.17, Acc@5: 99.48, TTA Acc@1: 80.34, Acc@5: 99.48
2025-06-11 15:27:45,909 - log - INFO - iter:600/3669, clip_acc1=80.16667175292969, tta_acc1=80.33333587646484
2025-06-11 15:27:45,910 - log - INFO - iter:600/3669, Original Acc@1: 80.17, Acc@5: 99.50, TTA Acc@1: 80.33, Acc@5: 99.50
2025-06-11 15:28:32,795 - log - INFO - iter:620/3669, clip_acc1=80.64515686035156, tta_acc1=80.64515686035156
2025-06-11 15:28:32,796 - log - INFO - iter:620/3669, Original Acc@1: 80.65, Acc@5: 99.52, TTA Acc@1: 80.65, Acc@5: 99.52
2025-06-11 15:29:19,740 - log - INFO - iter:640/3669, clip_acc1=80.46875, tta_acc1=80.15625
2025-06-11 15:29:19,740 - log - INFO - iter:640/3669, Original Acc@1: 80.47, Acc@5: 99.53, TTA Acc@1: 80.16, Acc@5: 99.53
2025-06-11 15:30:06,477 - log - INFO - iter:660/3669, clip_acc1=80.30302429199219, tta_acc1=79.54544830322266
2025-06-11 15:30:06,477 - log - INFO - iter:660/3669, Original Acc@1: 80.30, Acc@5: 99.55, TTA Acc@1: 79.55, Acc@5: 99.55
2025-06-11 15:30:53,046 - log - INFO - iter:680/3669, clip_acc1=80.88235473632812, tta_acc1=79.70588684082031
2025-06-11 15:30:53,046 - log - INFO - iter:680/3669, Original Acc@1: 80.88, Acc@5: 99.56, TTA Acc@1: 79.71, Acc@5: 99.56
2025-06-11 15:31:39,787 - log - INFO - iter:700/3669, clip_acc1=80.57142639160156, tta_acc1=79.42857360839844
2025-06-11 15:31:39,788 - log - INFO - iter:700/3669, Original Acc@1: 80.57, Acc@5: 99.29, TTA Acc@1: 79.43, Acc@5: 99.29
2025-06-11 15:32:26,630 - log - INFO - iter:720/3669, clip_acc1=78.33333587646484, tta_acc1=77.22222137451172
2025-06-11 15:32:26,630 - log - INFO - iter:720/3669, Original Acc@1: 78.33, Acc@5: 96.53, TTA Acc@1: 77.22, Acc@5: 96.53
2025-06-11 15:33:13,478 - log - INFO - iter:740/3669, clip_acc1=76.21621704101562, tta_acc1=75.13513946533203
2025-06-11 15:33:13,478 - log - INFO - iter:740/3669, Original Acc@1: 76.22, Acc@5: 93.92, TTA Acc@1: 75.14, Acc@5: 93.92
2025-06-11 15:34:00,238 - log - INFO - iter:760/3669, clip_acc1=74.21053314208984, tta_acc1=73.15789794921875
2025-06-11 15:34:00,238 - log - INFO - iter:760/3669, Original Acc@1: 74.21, Acc@5: 91.45, TTA Acc@1: 73.16, Acc@5: 91.45
2025-06-11 15:34:46,859 - log - INFO - iter:780/3669, clip_acc1=72.30769348144531, tta_acc1=71.28205108642578
2025-06-11 15:34:46,859 - log - INFO - iter:780/3669, Original Acc@1: 72.31, Acc@5: 89.10, TTA Acc@1: 71.28, Acc@5: 89.10
2025-06-11 15:35:33,599 - log - INFO - iter:800/3669, clip_acc1=71.875, tta_acc1=70.875
2025-06-11 15:35:33,599 - log - INFO - iter:800/3669, Original Acc@1: 71.88, Acc@5: 88.50, TTA Acc@1: 70.88, Acc@5: 88.38
2025-06-11 15:36:20,390 - log - INFO - iter:820/3669, clip_acc1=72.19512176513672, tta_acc1=70.9756088256836
2025-06-11 15:36:20,390 - log - INFO - iter:820/3669, Original Acc@1: 72.20, Acc@5: 88.78, TTA Acc@1: 70.98, Acc@5: 88.66
2025-06-11 15:37:07,276 - log - INFO - iter:840/3669, clip_acc1=72.73809814453125, tta_acc1=71.54762268066406
2025-06-11 15:37:07,276 - log - INFO - iter:840/3669, Original Acc@1: 72.74, Acc@5: 89.05, TTA Acc@1: 71.55, Acc@5: 88.93
2025-06-11 15:37:53,975 - log - INFO - iter:860/3669, clip_acc1=73.13953399658203, tta_acc1=71.86046600341797
2025-06-11 15:37:53,975 - log - INFO - iter:860/3669, Original Acc@1: 73.14, Acc@5: 89.30, TTA Acc@1: 71.86, Acc@5: 89.19
2025-06-11 15:38:40,867 - log - INFO - iter:880/3669, clip_acc1=73.63636016845703, tta_acc1=72.38636016845703
2025-06-11 15:38:40,867 - log - INFO - iter:880/3669, Original Acc@1: 73.64, Acc@5: 89.55, TTA Acc@1: 72.39, Acc@5: 89.43
2025-06-11 15:39:27,572 - log - INFO - iter:900/3669, clip_acc1=73.77777862548828, tta_acc1=72.66667175292969
2025-06-11 15:39:27,572 - log - INFO - iter:900/3669, Original Acc@1: 73.78, Acc@5: 89.78, TTA Acc@1: 72.67, Acc@5: 89.67
2025-06-11 15:40:14,424 - log - INFO - iter:920/3669, clip_acc1=74.34782409667969, tta_acc1=73.2608642578125
2025-06-11 15:40:14,425 - log - INFO - iter:920/3669, Original Acc@1: 74.35, Acc@5: 90.00, TTA Acc@1: 73.26, Acc@5: 89.89
2025-06-11 15:41:01,310 - log - INFO - iter:940/3669, clip_acc1=74.7872314453125, tta_acc1=73.72340393066406
2025-06-11 15:41:01,311 - log - INFO - iter:940/3669, Original Acc@1: 74.79, Acc@5: 90.21, TTA Acc@1: 73.72, Acc@5: 90.11
2025-06-11 15:41:48,004 - log - INFO - iter:960/3669, clip_acc1=75.31250762939453, tta_acc1=74.27083587646484
2025-06-11 15:41:48,005 - log - INFO - iter:960/3669, Original Acc@1: 75.31, Acc@5: 90.42, TTA Acc@1: 74.27, Acc@5: 90.31
2025-06-11 15:42:34,608 - log - INFO - iter:980/3669, clip_acc1=75.40815734863281, tta_acc1=74.38774871826172
2025-06-11 15:42:34,609 - log - INFO - iter:980/3669, Original Acc@1: 75.41, Acc@5: 90.61, TTA Acc@1: 74.39, Acc@5: 90.51
