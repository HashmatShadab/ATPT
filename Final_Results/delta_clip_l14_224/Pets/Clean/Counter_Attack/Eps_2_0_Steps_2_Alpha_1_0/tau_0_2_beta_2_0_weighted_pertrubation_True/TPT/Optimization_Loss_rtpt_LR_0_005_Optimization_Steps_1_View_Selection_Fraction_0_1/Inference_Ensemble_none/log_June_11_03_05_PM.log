2025-06-11 15:05:51,717 - log - INFO - ==========================================
data:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/atpt_data/downstream_datasets
test_sets:Pets
dataset_mode:test
arch:delta_clip_l14_224
resolution:224
workers:4
no_pin_memory:False
batch_size:64
print_freq:20
gpu:0
no_cudnn_benchmark:False
n_ctx:4
ctx_init:a_photo_of_a
tpt_loss:rtpt
seed:0
output_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/atpt_data/delta_clip_l14_224/Pets
log_output_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/ATPT/Final_Results/delta_clip_l14_224/Pets
eps:0.0
alpha:0.0
alpha_eps_ratio:4.0
steps:0
lr:0.005
selection_p:0.1
tta_steps:1
ensemble_type:none
top_k:20
softmax_temp:0.01
counter_attack:True
counter_attack_type:pgd
counter_attack_steps:2
counter_attack_eps:2.0
counter_attack_alpha:1.0
counter_attack_tau_thres:0.2
counter_attack_beta:2.0
counter_attack_weighted_perturbations:True
pgd_clip_pure_i_text_embeddings:null
pgd_counter_and_clipure_i_lamda:1.0
selected_id_name:selected_topk.json
weighted_score_name:weighted_scores.json
batch_entropy_name:entropies.json
log_dir:/leonardo_work/EUHPC_R04_192/fmohamma/Adversarial_Robust_Clip/ATPT/Final_Results/delta_clip_l14_224/Pets/Clean/Counter_Attack/Eps_2_0_Steps_2_Alpha_1_0/tau_0_2_beta_2_0_weighted_pertrubation_True/TPT/Optimization_Loss_rtpt_LR_0_005_Optimization_Steps_1_View_Selection_Fraction_0_1/Inference_Ensemble_none

2025-06-11 15:05:51,718 - log - INFO - Use GPU: 0 for training
2025-06-11 15:07:56,508 - log - INFO - Freezing all parameters except prompt learner
2025-06-11 15:07:56,509 - log - INFO - => Model created: visual backbone delta_clip_l14_224
2025-06-11 15:07:56,530 - log - INFO - Number of test samples: 3669
2025-06-11 15:07:56,530 - log - INFO - Evaluating dataset: Pets
2025-06-11 15:07:56,531 - log - INFO - Starting evaluation with batch size: 64, selection percentage: 0.1
2025-06-11 15:07:56,531 - log - INFO - Test-time adaptation steps: 1, learning rate: 0.005
2025-06-11 15:07:56,531 - log - INFO - Using counter-attack with epsilon: 2.000000, alpha: 0.000000, steps: 2, tau_thres: 0.2, beta: 2.0, weighted perturbation: True
2025-06-11 15:09:00,832 - log - INFO - iter:20/3669, clip_acc1=45.0, tta_acc1=50.0
2025-06-11 15:09:00,832 - log - INFO - iter:20/3669, Original Acc@1: 45.00, Acc@5: 90.00, TTA Acc@1: 50.00, Acc@5: 95.00
2025-06-11 15:09:47,795 - log - INFO - iter:40/3669, clip_acc1=47.5, tta_acc1=52.5
2025-06-11 15:09:47,795 - log - INFO - iter:40/3669, Original Acc@1: 47.50, Acc@5: 95.00, TTA Acc@1: 52.50, Acc@5: 97.50
2025-06-11 15:10:34,575 - log - INFO - iter:60/3669, clip_acc1=53.333335876464844, tta_acc1=56.66666793823242
2025-06-11 15:10:34,575 - log - INFO - iter:60/3669, Original Acc@1: 53.33, Acc@5: 96.67, TTA Acc@1: 56.67, Acc@5: 98.33
2025-06-11 15:11:21,164 - log - INFO - iter:80/3669, clip_acc1=53.75, tta_acc1=56.25
2025-06-11 15:11:21,164 - log - INFO - iter:80/3669, Original Acc@1: 53.75, Acc@5: 97.50, TTA Acc@1: 56.25, Acc@5: 98.75
2025-06-11 15:12:07,976 - log - INFO - iter:100/3669, clip_acc1=55.0, tta_acc1=58.0
2025-06-11 15:12:07,976 - log - INFO - iter:100/3669, Original Acc@1: 55.00, Acc@5: 98.00, TTA Acc@1: 58.00, Acc@5: 99.00
2025-06-11 15:12:54,978 - log - INFO - iter:120/3669, clip_acc1=60.833335876464844, tta_acc1=63.333335876464844
2025-06-11 15:12:54,979 - log - INFO - iter:120/3669, Original Acc@1: 60.83, Acc@5: 98.33, TTA Acc@1: 63.33, Acc@5: 99.17
2025-06-11 15:13:41,710 - log - INFO - iter:140/3669, clip_acc1=63.57143020629883, tta_acc1=65.71428680419922
2025-06-11 15:13:41,710 - log - INFO - iter:140/3669, Original Acc@1: 63.57, Acc@5: 98.57, TTA Acc@1: 65.71, Acc@5: 99.29
2025-06-11 15:14:30,225 - log - INFO - iter:160/3669, clip_acc1=66.25, tta_acc1=68.125
2025-06-11 15:14:30,225 - log - INFO - iter:160/3669, Original Acc@1: 66.25, Acc@5: 98.75, TTA Acc@1: 68.12, Acc@5: 99.38
2025-06-11 15:15:17,105 - log - INFO - iter:180/3669, clip_acc1=68.33333587646484, tta_acc1=70.0
2025-06-11 15:15:17,106 - log - INFO - iter:180/3669, Original Acc@1: 68.33, Acc@5: 98.89, TTA Acc@1: 70.00, Acc@5: 99.44
2025-06-11 15:16:03,699 - log - INFO - iter:200/3669, clip_acc1=70.0, tta_acc1=71.5
2025-06-11 15:16:03,700 - log - INFO - iter:200/3669, Original Acc@1: 70.00, Acc@5: 98.50, TTA Acc@1: 71.50, Acc@5: 99.00
2025-06-11 15:16:50,541 - log - INFO - iter:220/3669, clip_acc1=72.2727279663086, tta_acc1=73.18181610107422
2025-06-11 15:16:50,542 - log - INFO - iter:220/3669, Original Acc@1: 72.27, Acc@5: 98.64, TTA Acc@1: 73.18, Acc@5: 99.09
2025-06-11 15:17:37,196 - log - INFO - iter:240/3669, clip_acc1=71.66667175292969, tta_acc1=72.08333587646484
2025-06-11 15:17:37,196 - log - INFO - iter:240/3669, Original Acc@1: 71.67, Acc@5: 98.75, TTA Acc@1: 72.08, Acc@5: 99.17
2025-06-11 15:18:23,743 - log - INFO - iter:260/3669, clip_acc1=71.92308044433594, tta_acc1=71.92308044433594
2025-06-11 15:18:23,743 - log - INFO - iter:260/3669, Original Acc@1: 71.92, Acc@5: 98.85, TTA Acc@1: 71.92, Acc@5: 99.23
2025-06-11 15:19:10,284 - log - INFO - iter:280/3669, clip_acc1=73.21428680419922, tta_acc1=73.21428680419922
2025-06-11 15:19:10,284 - log - INFO - iter:280/3669, Original Acc@1: 73.21, Acc@5: 98.93, TTA Acc@1: 73.21, Acc@5: 99.29
2025-06-11 15:19:57,114 - log - INFO - iter:300/3669, clip_acc1=73.33333587646484, tta_acc1=73.33333587646484
2025-06-11 15:19:57,114 - log - INFO - iter:300/3669, Original Acc@1: 73.33, Acc@5: 99.00, TTA Acc@1: 73.33, Acc@5: 99.33
2025-06-11 15:20:43,727 - log - INFO - iter:320/3669, clip_acc1=73.75, tta_acc1=74.0625
2025-06-11 15:20:43,727 - log - INFO - iter:320/3669, Original Acc@1: 73.75, Acc@5: 99.06, TTA Acc@1: 74.06, Acc@5: 99.38
2025-06-11 15:21:30,393 - log - INFO - iter:340/3669, clip_acc1=75.0, tta_acc1=75.29412078857422
2025-06-11 15:21:30,393 - log - INFO - iter:340/3669, Original Acc@1: 75.00, Acc@5: 99.12, TTA Acc@1: 75.29, Acc@5: 99.41
2025-06-11 15:22:17,194 - log - INFO - iter:360/3669, clip_acc1=75.83333587646484, tta_acc1=76.11111450195312
2025-06-11 15:22:17,194 - log - INFO - iter:360/3669, Original Acc@1: 75.83, Acc@5: 99.17, TTA Acc@1: 76.11, Acc@5: 99.44
2025-06-11 15:23:03,804 - log - INFO - iter:380/3669, clip_acc1=76.84210968017578, tta_acc1=76.84210968017578
2025-06-11 15:23:03,804 - log - INFO - iter:380/3669, Original Acc@1: 76.84, Acc@5: 99.21, TTA Acc@1: 76.84, Acc@5: 99.47
2025-06-11 15:23:50,735 - log - INFO - iter:400/3669, clip_acc1=78.0, tta_acc1=78.0
2025-06-11 15:23:50,735 - log - INFO - iter:400/3669, Original Acc@1: 78.00, Acc@5: 99.25, TTA Acc@1: 78.00, Acc@5: 99.50
2025-06-11 15:24:37,257 - log - INFO - iter:420/3669, clip_acc1=78.5714340209961, tta_acc1=78.5714340209961
2025-06-11 15:24:37,257 - log - INFO - iter:420/3669, Original Acc@1: 78.57, Acc@5: 99.05, TTA Acc@1: 78.57, Acc@5: 99.29
2025-06-11 15:25:24,002 - log - INFO - iter:440/3669, clip_acc1=79.54544830322266, tta_acc1=79.54544830322266
2025-06-11 15:25:24,003 - log - INFO - iter:440/3669, Original Acc@1: 79.55, Acc@5: 99.09, TTA Acc@1: 79.55, Acc@5: 99.32
2025-06-11 15:26:10,434 - log - INFO - iter:460/3669, clip_acc1=80.43477630615234, tta_acc1=80.43477630615234
2025-06-11 15:26:10,435 - log - INFO - iter:460/3669, Original Acc@1: 80.43, Acc@5: 99.13, TTA Acc@1: 80.43, Acc@5: 99.35
2025-06-11 15:26:57,183 - log - INFO - iter:480/3669, clip_acc1=81.25000762939453, tta_acc1=81.25000762939453
2025-06-11 15:26:57,183 - log - INFO - iter:480/3669, Original Acc@1: 81.25, Acc@5: 99.17, TTA Acc@1: 81.25, Acc@5: 99.38
2025-06-11 15:27:43,887 - log - INFO - iter:500/3669, clip_acc1=82.00000762939453, tta_acc1=82.00000762939453
2025-06-11 15:27:43,888 - log - INFO - iter:500/3669, Original Acc@1: 82.00, Acc@5: 99.20, TTA Acc@1: 82.00, Acc@5: 99.40
2025-06-11 15:28:30,553 - log - INFO - iter:520/3669, clip_acc1=82.30769348144531, tta_acc1=82.30769348144531
2025-06-11 15:28:30,553 - log - INFO - iter:520/3669, Original Acc@1: 82.31, Acc@5: 99.23, TTA Acc@1: 82.31, Acc@5: 99.42
2025-06-11 15:29:17,302 - log - INFO - iter:540/3669, clip_acc1=81.85185241699219, tta_acc1=82.03703308105469
2025-06-11 15:29:17,302 - log - INFO - iter:540/3669, Original Acc@1: 81.85, Acc@5: 99.26, TTA Acc@1: 82.04, Acc@5: 99.44
2025-06-11 15:30:03,946 - log - INFO - iter:560/3669, clip_acc1=81.60713958740234, tta_acc1=81.78571319580078
2025-06-11 15:30:03,947 - log - INFO - iter:560/3669, Original Acc@1: 81.61, Acc@5: 99.29, TTA Acc@1: 81.79, Acc@5: 99.46
2025-06-11 15:30:50,685 - log - INFO - iter:580/3669, clip_acc1=80.51724243164062, tta_acc1=81.20689392089844
2025-06-11 15:30:50,685 - log - INFO - iter:580/3669, Original Acc@1: 80.52, Acc@5: 99.31, TTA Acc@1: 81.21, Acc@5: 99.48
2025-06-11 15:31:37,259 - log - INFO - iter:600/3669, clip_acc1=80.5, tta_acc1=81.16667175292969
2025-06-11 15:31:37,259 - log - INFO - iter:600/3669, Original Acc@1: 80.50, Acc@5: 99.33, TTA Acc@1: 81.17, Acc@5: 99.50
2025-06-11 15:32:24,041 - log - INFO - iter:620/3669, clip_acc1=80.96774291992188, tta_acc1=81.45161437988281
2025-06-11 15:32:24,041 - log - INFO - iter:620/3669, Original Acc@1: 80.97, Acc@5: 99.35, TTA Acc@1: 81.45, Acc@5: 99.52
2025-06-11 15:33:15,767 - log - INFO - iter:640/3669, clip_acc1=80.78125, tta_acc1=80.9375
2025-06-11 15:33:15,768 - log - INFO - iter:640/3669, Original Acc@1: 80.78, Acc@5: 99.38, TTA Acc@1: 80.94, Acc@5: 99.53
2025-06-11 15:34:02,488 - log - INFO - iter:660/3669, clip_acc1=80.6060562133789, tta_acc1=80.30302429199219
2025-06-11 15:34:02,488 - log - INFO - iter:660/3669, Original Acc@1: 80.61, Acc@5: 99.39, TTA Acc@1: 80.30, Acc@5: 99.55
2025-06-11 15:34:49,020 - log - INFO - iter:680/3669, clip_acc1=81.17647552490234, tta_acc1=80.44117736816406
2025-06-11 15:34:49,021 - log - INFO - iter:680/3669, Original Acc@1: 81.18, Acc@5: 99.41, TTA Acc@1: 80.44, Acc@5: 99.56
2025-06-11 15:35:35,725 - log - INFO - iter:700/3669, clip_acc1=80.85713958740234, tta_acc1=80.14285278320312
2025-06-11 15:35:35,725 - log - INFO - iter:700/3669, Original Acc@1: 80.86, Acc@5: 99.14, TTA Acc@1: 80.14, Acc@5: 99.29
2025-06-11 15:36:22,470 - log - INFO - iter:720/3669, clip_acc1=78.61111450195312, tta_acc1=77.91667175292969
2025-06-11 15:36:22,470 - log - INFO - iter:720/3669, Original Acc@1: 78.61, Acc@5: 96.39, TTA Acc@1: 77.92, Acc@5: 96.53
2025-06-11 15:37:09,125 - log - INFO - iter:740/3669, clip_acc1=76.48648834228516, tta_acc1=75.8108139038086
2025-06-11 15:37:09,125 - log - INFO - iter:740/3669, Original Acc@1: 76.49, Acc@5: 93.78, TTA Acc@1: 75.81, Acc@5: 93.92
2025-06-11 15:37:55,831 - log - INFO - iter:760/3669, clip_acc1=74.47368621826172, tta_acc1=73.8157958984375
2025-06-11 15:37:55,831 - log - INFO - iter:760/3669, Original Acc@1: 74.47, Acc@5: 91.32, TTA Acc@1: 73.82, Acc@5: 91.45
2025-06-11 15:38:42,350 - log - INFO - iter:780/3669, clip_acc1=72.56410217285156, tta_acc1=71.92308044433594
2025-06-11 15:38:42,351 - log - INFO - iter:780/3669, Original Acc@1: 72.56, Acc@5: 88.97, TTA Acc@1: 71.92, Acc@5: 89.10
2025-06-11 15:39:29,093 - log - INFO - iter:800/3669, clip_acc1=72.125, tta_acc1=71.5
2025-06-11 15:39:29,093 - log - INFO - iter:800/3669, Original Acc@1: 72.12, Acc@5: 88.38, TTA Acc@1: 71.50, Acc@5: 88.38
2025-06-11 15:40:15,806 - log - INFO - iter:820/3669, clip_acc1=72.43902587890625, tta_acc1=71.58536529541016
2025-06-11 15:40:15,806 - log - INFO - iter:820/3669, Original Acc@1: 72.44, Acc@5: 88.66, TTA Acc@1: 71.59, Acc@5: 88.66
2025-06-11 15:41:02,595 - log - INFO - iter:840/3669, clip_acc1=72.9761962890625, tta_acc1=72.14286041259766
2025-06-11 15:41:02,595 - log - INFO - iter:840/3669, Original Acc@1: 72.98, Acc@5: 88.93, TTA Acc@1: 72.14, Acc@5: 88.93
2025-06-11 15:41:49,200 - log - INFO - iter:860/3669, clip_acc1=73.3720932006836, tta_acc1=72.44185638427734
2025-06-11 15:41:49,200 - log - INFO - iter:860/3669, Original Acc@1: 73.37, Acc@5: 89.19, TTA Acc@1: 72.44, Acc@5: 89.19
2025-06-11 15:42:35,941 - log - INFO - iter:880/3669, clip_acc1=73.86363220214844, tta_acc1=72.95454406738281
2025-06-11 15:42:35,941 - log - INFO - iter:880/3669, Original Acc@1: 73.86, Acc@5: 89.43, TTA Acc@1: 72.95, Acc@5: 89.43
